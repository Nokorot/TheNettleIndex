{% extends 'header.html' %}

{% block head %} 
<title>The Nettle Index</title>
{% endblock %} 

{% block title %}The Nettle Index{% endblock title %}

{% block body %}
<div class="filter-container">
  <form method="get" action="/" class="filter-form">
    <input type="text" name="search" placeholder="Search entries..." value="{{ request.args.get('search', '') }}" class="filter-input">
    <select name="tags" multiple class="filter-select">
      {% for tag in all_tags %}
      <option value="{{ tag }}" {% if tag in selected_tags %}selected{% endif %}>{{ tag }}</option>
      {% endfor %}
    </select>
    <button type="submit" class="filter-button">Filter</button>
  </form>
</div>

<div class="forum-container">
  {% for entry in entries %}
  <div class="entry">
    <div class="entry-body">
      <div class="entry-text">
        <div class="entry-title">
          <a href="/entry/{{ entry.id }}">{{ entry.name }}</a>
        </div>
        <div class="entry-meta">
          Posted by <strong>{{ entry.owner }}</strong> on {{ entry.time_added | pretty_time }}
        </div>
        <div class="entry-content">
          {{ entry.description }}
        </div>
        <div class="entry-tags">
          Tags:
          {% for tag in entry.tags %}
          <span class="tag">{{ tag }}</span>
          {% endfor %}
        </div>
      </div>
      {% if entry.image_url %}
      <div class="entry-image">
        <img src="{{ entry.image_url }}" alt="Image for {{ entry.name }}" class="entry-image">
      </div>
      {% endif %}
    </div>
  </div>
  {% endfor %}
</div>

<!-- Pagination controls -->
<div class="pagination-container">
  {% if page > 1 %}
  <a href="/?search={{ request.args.get('search', '') }}&page={{ page - 1 }}&tags={{ selected_tags | join(',') }}" class="pagination-link">Previous</a>
  {% endif %}
  <span class="pagination-info">Page {{ page }} of {{ total_pages }}</span>
  {% if page < total_pages %}
  <a href="/?search={{ request.args.get('search', '') }}&page={{ page + 1 }}&tags={{ selected_tags | join(',') }}" class="pagination-link">Next</a>
  {% endif %}
</div>
{% endblock %}
